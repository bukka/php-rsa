<?php

function rsa_test_key_create($params, $ctext_ex) {
	$rsa = new RSA();
	foreach ($params as $param_name => $param_value) {
		$method = 'set' . strtoupper($param_name);
		$rsa->$method($param_value);
	}

	return array($rsa, pack('H*', substr($ctext_ex, 2)));
}

function rsa_test_key1() {
	$params = array(
		'n' => "0x" .
			"00AA36ABCE88ACFDFF55523C7FC4523F" .
			"90EFA00DF3774A259F2E62B4C5D99CB5" .
			"ADB300A0285E5301930E0C70FB687693" .
			"9CE616CE624A11E0086D341EBCACA0A1" .
			"F5",

		'e' => "0x11",

		'd' => "0x" .
			"0A033748626487695F5F30BC38B98B44" .
			"C2CD2DFF434098CD20D8A138D090BF64" .
			"797C3FA7A2CDCB3CD1E0BDBA2654B4F9" .
			"DF8E8AE59D733D9F33B301624AFD1D51",

		'p' => "0x" .
			"00D840B41666B42E92EA0DA3B43204B5" .
			"CFCE3352524D0416A5A441E700AF4612" .
			"0D",

		'q' => "0x" .
			"00C97FB1F027F453F6341233EAAAD1D9" .
			"353F6C42D08866B1D05A0F2035028B9D" .
			"89",

		'dmp1' => "0x" .
			"590B9572A2C2A9C406059DC2AB2F1DAF" .
			"EB7E8B4F10A7549E8EEDF5B4FCE09E05",

		'dmq1' => "0x" .
			"008E3C0521FE15E0EA06A36FF0F10C99" .
			"52C35B7A7514FD3238B80AAD5298628D" .
			"51",

		'iqmp' => "0x" .
			"363FF7189DA8E90B1D341F71D09B76A8" .
			"A943E11D10B24D249F2DEAFEF80C1826",
	);

	$ctext_ex = "0x" .
		"1b8f05f9ca1a79526e53f3cc514fdb89" .
		"2bfb9193231e78b992e68d50a480cb52" .
		"33895c74958d5d02ab8c0fd040eb5844" .
		"b005c39ed8274a9dbfa80671409439d2";

	return rsa_test_key_create($params, $ctext_ex);
}

function rsa_test_key2() {
	$params = array(
		'n' => "0x" .
			"00A3079A90DF0DFD72AC090CCC2A78B8" .
			"7413133E40759C98FAF8204F358A0B26" .
			"3C6770E783A93B6971B73779D2717BE8" .
			"3477CF",

		'e' => "0x3",

		'd' => "0x" .
			"6CAFBC6094B3FE4C72B0B332C6FB25A2" .
			"B76229804E6865FCA45A74DF0F8FB841" .
			"3B52C0D0E53D9B590FF19BE79F49DD21" .
			"E5EB",

		'p' => "0x" .
			"00CF2035028B9D869840B41666B42E92" .
			"EA0DA3B43204B5CFCE91",

		'q' => "0x" .
			"00C97FB1F027F453F6341233EAAAD1D9" .
			"353F6C42D08866B1D05F",

		'dmp1' => "0x" .
			"008A1578AC5D13AF102B22B999CD7461" .
			"F15E6D22CC0323DFDF0B",

		'dmq1' => "0x" .
			"008655214AC54D8D4ECD6177F1C73690" .
			"CE2A482C8B0599CBE03F",

		'iqmp' => "0x" .
			"0083EFEFB8A9A40D1DB6ED98AD84ED13" .
			"35DCC108F322D057CF8D",
	);

	$ctext_ex = "0x" .
		"14bddd28c98335192380e8e549b1582a" .
		"8b40b4486d03a6a5311f1fd5f0a180e4" .
		"17530329a9349074b152135429082452" .
		"6251";

	return rsa_test_key_create($params, $ctext_ex);
}

function rsa_test_key3() {
	$params = array(
		'n' => "0x" .
			"00BBF82F090682CE9C2338AC2B9DA871" .
			"F7368D07EED41043A440D6B6F07454F5" .
			"1FB8DFBAAF035C02AB61EA48CEEB6FCD" .
			"4876ED520D60E1EC4619719D8A5B8B80" .
			"7FAFB8E0A3DFC737723EE6B4B7D93A25" .
			"84EE6A649D060953748834B245459839" .
			"4EE0AAB12D7B61A51F527A9A41F6C168" .
			"7FE2537298CA2A8F5946F8E5FD091DBD" .
			"CB",

		'e' => "0x11",

		'd' => "0x" .
			"00A5DAFC5341FAF289C4B988DB30C1CD" .
			"F83F31251E0668B42784813801579641" .
			"B29410B3C7998D6BC465745E5C392669" .
			"D6870DA2C082A939E37FDCB82EC93EDA" .
			"C97FF3AD5950ACCFBC111C76F1A95294" .
			"44E56AAF68C56C092CD38DC3BEF5D20A" .
			"939926ED4F74A13EDDFBE1A1CECC4894" .
			"AF9428C2B7B8883FE4463A4BC85B1CB3" .
			"C1",

		'p' => "0x" .
			"00EECFAE81B1B9B3C908810B10A1B560" .
			"0199EB9F44AEF4FDA493B81A9E3D84F6" .
			"32124EF0236E5D1E3B7E28FAE7AA040A" .
			"2D5B252176459D1F397541BA2A58FB65" .
			"99",

		'q' => "0x" .
			"00C97FB1F027F453F6341233EAAAD1D9" .
			"353F6C42D08866B1D05A0F2035028B9D" .
			"869840B41666B42E92EA0DA3B43204B5" .
			"CFCE3352524D0416A5A441E700AF4615" .
			"03",

		'dmp1' => "0x" .
			"54494CA63EBA0337E4E24023FCD69A5A" .
			"EB07DDDC0183A4D0AC9B54B051F2B13E" .
			"D9490975EAB77414FF59C1F7692E9A2E" .
			"202B38FC910A474174ADC93C1F67C981",

		'dmq1' => "0x" .
			"471E0290FF0AF0750351B7F878864CA9" .
			"61ADBD3A8A7E991C5C0556A94C3146A7" .
			"F9803F8F6F8AE342E931FD8AE47A220D" .
			"1B99A495849807FE39F9245A9836DA3D",

		'iqmp' => "0x" .
			"00B06C4FDABB6301198D265BDBAE9423" .
			"B380F271F73453885093077FCD39E211" .
			"9FC98632154F5883B167A967BF402B4E" .
			"9E2E0F9656E698EA3666EDFB25798039" .
			"F7",
	);

	$ctext_ex = "0x" .
		"b8246b56a6ed5881aeb585d9a25b2ad7" .
		"90c417e080681bf1ac2bc3deb69d8bce" .
		"f0c4366fec400af052a72e9b0effb5b3" .
		"f2f192dbeaca03c12740057113bf1f06" .
		"69ac22e9f3a7852e3c15d913cab0b886" .
		"3a95c99294ce8674214954610346f4d4" .
		"74b26f7c48b42ee68e1f572a1fc4026a" .
		"c456b4f59f7b621ea1b9d88f64202fb1";

	return rsa_test_key_create($params, $ctext_ex);
}
